{{Header}} {{hide_all_banners}} {{Title|
title={{project_name_long}} for KVM
}}{{#seo:
|description={{project_name_short}} for KVM
|image=Download-kvm.jpg
}}
{{Contributor|
|status=stable
|about=About this {{PAGENAME}} Page
|difficulty=medium
|contributor=[https://forums.{{project_clearnet}}/users/hulahoop HulaHoop]
|support=[[KVM/Support|Community support only!]]
}}
[[File:Download-kvm.jpg|<code>unofficial logo re-design for the [https://www.linux-kvm.org KVM] virtualizer + Kicksecure</code>|thumb]]
{{intro|
This is the KVM flavor of the {{project_name_short}} project.
}}
{{Community_Support|scope=page}}
= Introduction =
Much of the warnings and use case instructions from the {{project_name_short}} edition, such as running the OS [[KVM#Command_Line_Interface_.28CLI.29|headlessly]] or using [[KVM#Shared_Folders|shared folders]], are applicable.

For more details about {{project_name_short}}, check [[About|{{project_name_short}}]] [[About|pages]].

Support tickets should be forwarded to the [https://forums.{{project_clearnet}}/c/kvm KVM subforum].

= Build from Scratch =

Advanced users are encouraged to [[Dev/Build_Documentation|build]] {{project_name_short}} images for high security assurance.

= Download {{project_name_short}} =

<!-- Extra terms of service notice because KVM has no VM import dialog which could present TOS. -->
{{tos}}

'''{{free}}'''

{{Tab
|type=controller
|content=

<!-- ────────────────  SECTION 1  ──────────────── -->
{{Tab
|active=true
|title= == GUI ==
|image=[[File:Clipart-gui.svg|alt=Symbol representing GUI]]
|content=

  {{Tab                      <!-- nested controller -->
  |type=controller
  |addToClass=margin-top-10
  |content=

    {{Tab
    |active=true
    |title= === stable Xfce ===
    |image=[[File:Rg1024_brick_tile.png]]
    |content=
        {{DownloadTableUnified
            |project_name={{project_name_short}}
            |os_keyword=kvm
            |os_name=KVM
            |version_type=stable
            |flavor=Xfce
            |after_slash=libvirt
            |extension=Intel_AMD64.qcow2.libvirt.xz
            |version={{Version_KVM}}
        }} <!-- close DownloadTableUnified -->
    }} <!-- close tab -->

    {{Tab
    |title= === testers Xfce ===
    |image=[[File:Cornues.png]]
    |content=
        {{DownloadTableUnified
            |project_name={{project_name_short}}
            |os_keyword=kvm
            |os_name=KVM
            |version_type=testers
            |flavor=Xfce
            |after_slash=libvirt
            |extension=Intel_AMD64.qcow2.libvirt.xz
            |version={{VersionTesters}}
        }} <!-- close DownloadTableUnified -->    }} <!-- close tab -->

  }} <!-- close nested controller -->

}} <!-- close tab: Section 1 -->

<!-- ────────────────  SECTION 2  ──────────────── -->
{{Tab
|title= == CLI ==
|image=[[File:Utilities-terminal.png|alt=Symbol representing CLI|50px]]
|content=

  {{Tab                      <!-- nested controller -->
  |type=controller
  |addToClass=margin-top-10
  |content=

    {{Tab
    |active=true
    |title= === stable CLI ===
    |image=[[File:Rg1024_brick_tile.png]]
    |content=
        {{DownloadTableUnified
            |project_name={{project_name_short}}
            |os_keyword=kvm
            |os_name=KVM
            |version_type=stable
            |flavor=CLI
            |after_slash=libvirt
            |extension=Intel_AMD64.qcow2.libvirt.xz
            |version={{Version_KVM}}
        }} <!-- close DownloadTableUnified -->    }} <!-- close tab -->

    {{Tab
    |title= === testers CLI ===
    |image=[[File:Cornues.png]]
    |content=
        {{DownloadTableUnified
            |project_name={{project_name_short}}
            |os_keyword=kvm
            |os_name=KVM
            |version_type=testers
            |flavor=CLI
            |after_slash=libvirt
            |extension=Intel_AMD64.qcow2.libvirt.xz
            |version={{VersionTesters}}
        }} <!-- close DownloadTableUnified -->
    }} <!-- close tab -->
  }} <!-- close nested controller -->

}} <!-- close tab: Section 2 -->

}} <!-- close top‑level controller -->

{{mbox
|icon=fa-solid fa-exclamation cs-red
|addToClass=cs-yellow-light
|text=
'''Note:''' Save your download to your usual <code>~/Downloads</code> folder.
}} <!-- End mbox -->

= Decompress =

Use {{Code2|tar}} to decompress the archive.

{{CodeSelect|code=
tar -xvf Kicksecure*.libvirt.xz
}}

Do not use {{Code2|unxz}}! Extract the images using {{Code2|tar}}.

= Importing {{project_name_short}} VM Template =

The supplied XML files serve as a description for libvirt and define the properties of a {{project_name_short}} VM and the networking it should have.
{{Box|text=
'''1.''' {{project_name_short}} works with the network named ''default'' out of the box.

'''2.''' Import the {{project_name_short}} image.

{{CodeSelect|code=
virsh -c qemu:///system define Kicksecure*.xml
}}
}}

= Moving the {{project_name_short}} Image File =

The XML files are configured to point to the default storage location of <code>/var/lib/libvirt/images</code>. The following steps move the images there so the machines can boot.

<u>Note:</u> Changing the default location may cause conflicts with SELinux, which will prevent the machines from booting.

It is recommended to move the image file instead of copying it.

{{CodeSelect|code=
sudo mv Kicksecure*.qcow2 /var/lib/libvirt/images/Kicksecure.qcow2
}}

{{Anchor|sparse files}}

= Shared Folders =

Select the operating system running inside the VM.

{{Tab
|type=controller
|content=
{{Tab
|title= === {{project_name_short}} ===
|image=[[File:Kicksecure-logo-rectangle.svg|25px]]
|content=
{{Box|text=
'''1.''' Ensure the virtual machine is powered down.

'''2.''' Host folder preparation: On the host operating system, create a folder to be shared with the {{VM}}. For example, on a Linux host operating system:

Replace user name <code>user</code> with your actual user name.

{{CodeSelect|code=
mkdir /home/user/shared
}}

'''3.''' Adjust permissions on the host to allow read and write access to the folder with chmod.

Replace user name <code>user</code> with your actual user name.

{{CodeSelect|code=
chmod 777 /home/user/shared
}}

'''4.''' Click <code>virt-manager</code> &rarr; double-click on VM &rarr; <code>View</code> &rarr; <code>Details</code> &rarr; <code>Add Hardware</code>.

'''5.''' Click the <code>Filesystem</code> device in the list of devices on the left side of the window that pops up.

'''6.''' Choose the following settings.

Replace user name <code>user</code> with your actual user name.

* <u>Driver:</u> virtio-9p
* <u>Source path:</u> <code>/home/user/shared</code>
* <u>Target Path:</u> <code>shared</code>
** Note: This field must contain the word <code>shared</code>, regardless of the name of the folder being shared with the VM. This is because this name is used to identify and mount the shared folder in {{project_name_short}}.

'''7.''' Ensure <code>Export filesystem as readonly mount</code> is unchecked. <ref>
If you do not wish to write to that folder from within the VM, you are free to check/enable this setting.
</ref>

'''8.''' Click <code>Finish</code>.

'''9.''' Click <code>View</code> &rarr; <code>Console</code>, then click the play button in the toolbar to start the VM.

'''10.''' Done.

The shared folder will be accessible as <code>/mnt/shared</code>. <ref>This is hardcoded in [https://github.com/{{project_name_short}}/vm-config-dist/blob/master/usr/libexec/vm-config-dist/mount-shared <code>/usr/libexec/vm-config-dist/mount-shared</code>].</ref> The folder can be opened using a [[Software#File Manager|file manager]] such as Thunar, for example. To open it using the command line, run:

{{CodeSelect|code=
cd /mnt/shared
}}
}}
}}

{{Tab
|title= === Whonix ===
|image=[[File:Whonix-logo-icon.svg|25px]]
|content=
Same as Kicksecure. Follow the same instructions as for Kicksecure.
}}
}}

= Footnotes =
{{reflist|close=1}}

{{Footer}}

[[Category:Documentation]]