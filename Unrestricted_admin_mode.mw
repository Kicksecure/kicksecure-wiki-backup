{{Header}}
{{title|title=
Unrestricted Admin Mode
}}
{{#seo:
|description={{project_name_short}} allows configuration for unrestricted admin mode, enabling the default user account to access privilege escalation tools like sudo and pkexec.
|image=Unrestricted_admin_mode.png
}}
{{passwords_mininav}}
[[File:Unrestricted_admin_mode.png|200px|thumb]]
[[File:kicksecure-remove-user-sysmaint-split.png|200px|thumb|remove <code>user-sysmaint-split</code> boot menu entry]]
{{intro|
In {{project_name_short}}, administrative ("[[root|<code>root</code>]]") access is restricted by default for greater security. However, '''unrestricted admin mode can be configured'''. Read more about unrestricted admin mode and how to configure {{project_name_short}} to suit your needs.
}}
__FORCETOC__
= Overview =

'''Unrestricted admin mode''' is, in some regards, the opposite of [[sysmaint|<code>user-sysmaint-split</code>]]. In unrestricted admin mode, standard methods to perform tasks that require administrative rights, such as <code>sudo</code> and <code>pkexec</code>, are available for the {{project_name_short}} default limited account <code>user</code>.

Most other operating systems do not include <code>user-sysmaint-split</code> by default, so they do not refer to this as "unrestricted admin mode". In such systems, unrestricted admin mode is implied. However, {{project_name_short}} provides the flexibility to switch between <code>user-sysmaint-split</code> and unrestricted admin mode based on your needs.

{{project_name_short}} LXQt and {{project_name_short}} for Qubes includes [[sysmaint|<code>user-sysmaint-split</code>]] by default.

= Uninstalling user-sysmaint-split and Enabling Unrestricted Admin Mode =

Since [[sysmaint|<code>user-sysmaint-split</code>]] is installed by default, '''unrestricted admin mode''' must be explicitly enabled. This section documents how to disable <code>user-sysmaint-split</code> and switch to unrestricted admin mode, where the <code>user</code> account can use <code>sudo</code>.

{{Box|text=
{{Icon|fa-solid fa-exclamation cs-yellow}} '''Optional. Discouraged.'''

<u>Warnings:</u>

* <u>Privilege escalation risk:</u> Reverting to unrestricted admin mode increases the risk of privilege escalation attacks and may weaken system security.
* <u>Avoid <code>apt</code> removal:</u> It is discouraged to use <code>apt</code> to remove <code>user-sysmaint-split</code>, to avoid meta package removal issues (problems that can occur when important packages are removed together; for elaboration, see [[Debian Packages]]). Instead, it is recommended to proceed as per the instructions below.
* <u>Later reinstallation:</u> Uninstalling and later reinstalling <code>user-sysmaint-split</code> should work (we did quite a bit of work to make it so that the package can be removed and reinstalled without breaking things, though we do not test this as much as we test other features). On a technical level, you can do this.
* <u>Security model broken:</u> The security model is broken by removing <code>user-sysmaint-split</code>. That is, once you uninstall <code>user-sysmaint-split</code>, if any malware affects the <code>user</code> account, it can elevate to root, and at that point reinstalling <code>user-sysmaint-split</code> will not make your system secure again. However, if <code>user-sysmaint-split</code> had never been removed in the first place, then malware that attacked the <code>user</code> account will have a much harder time elevating to root.
}}

Platform specific. Select your platform.

{{Tab
|type=controller
|content=

{{Tab
|title= == {{project_name_short}} ==
|image=[[File:{{project_name_short}}-logo-icon.svg]]
|content=

Select a method.

{{Tab
|type=controller
|content=

{{Tab
|title= === using boot menu ===
|content=
If the <code>user-sysmaint-split</code> package is installed by default, the easiest way to remove it is by using the {{BootEntries|key=sysremove}} boot option on the GRUB screen.

{{IconSet|h1|1}} Reboot the machine.

{{IconSet|h1|2}} Select {{BootEntries|key=sysremove}} from the list of boot options.

'''Figure:''' ''Remove <code>user-sysmaint-split</code> boot menu entry''

[[File:kicksecure-remove-user-sysmaint-split.png|600px|Remove <code>user-sysmaint-split</code> boot menu entry]]

{{IconSet|h1|3}} Authenticate as necessary to log in as the <code>sysmaint</code> account. You may have to provide a disk encryption passphrase and/or the user password for the <code>sysmaint</code> account, if either or both passwords are set.

{{IconSet|h1|4}} Type the word <code>yes</code> into the dialog box confirming that you really do want to uninstall <code>user-sysmaint-split</code>.

{{IconSet|h1|5}} Click "OK". A terminal window will appear, showing the logs generated while uninstalling <code>user-sysmaint-split</code>.

{{IconSet|h1|6}} When the text <code>Command exited. You may close this window safely</code> appears, close the terminal window. The system will automatically reboot.

{{IconSet|h1|7}} Done.

The process of removing <code>user-sysmaint-split</code> is now complete.
}}

{{Tab
|title= === using dummy-dependency ===
|content=
Alternatively, you can use [[Debian_Packages#dummy-dependency|<code>dummy-dependency</code>]] to remove the <code>user-sysmaint-split</code> package while booted in {{BootEntries|key=syspers}} (a special startup mode used for system changes). <ref>
The <code>--purge</code> option is optional and not required in this case when using <code>dummy-dependency</code>, because <code>user-sysmaint-split</code> has been designed without configuration files in the <code>/etc</code> folder. Instead, <code>user-sysmaint-split</code> uses symlinks, which are deleted upon removal. This design ensures that a standard <code>apt remove user-sysmaint-split</code> will not result in unexpected functionality, such as parts of <code>user-sysmaint-split</code> (e.g., boot menu entries) still being active.
</ref>

{{CodeSelect|code=
sudo dummy-dependency --purge --yes user-sysmaint-split
}}

}} <!-- close tab -->
}} <!-- close tab -->
}}

{{Tab
|title= == {{q_project_name_long}} ==
|image=[[File:Qubes-logo-icon.png]]
|content=
{{IconSet|h1|1}} Notice of alternative option.

Is it really necessary? Potential alternative: [[Root#Qubes_Root_Console|Qubes Root Console]]

{{IconSet|h1|2}} Qubes version specific.

* <u>Qubes R4.2:</u> Open a [[Root#Qubes_Root_Console|Qubes Root Console]].
* <u>Qubes R4.3 and above:</u> Ensure that the <code>{{project_name_workstation_template}}</code> Template is booted in {{BootEntries|key=syspers}} (a special startup mode used for system changes).

{{IconSet|h1|3}} Uninstall the <code>user-sysmaint-split</code> package using [[Debian_Packages#dummy-dependency|<code>dummy-dependency</code>]].

Run:

{{CodeSelect|code=
sudo dummy-dependency --purge --yes user-sysmaint-split
}}

{{IconSet|h1|4}} Install <code>qubes-core-agent-passwordless-root</code> to allow the <code>user</code> account to elevate to root.

{{CodeSelect|code=
sudo apt install qubes-core-agent-passwordless-root
}}

{{IconSet|h1|5}} Shut down the Template.

{{IconSet|h1|6}} Reboot any AppVMs that are based on the Template.

{{IconSet|h1|7}} Done.

The process of removing <code>user-sysmaint-split</code> is now complete.
}} <!-- close tab -->

}} <!-- close tab controller -->

= Impact of unrestricted admin mode =
Uninstalling <code>user-sysmaint-split</code> removes the sysmaint session-related [[Grub|GRUB]] boot menu modifications and reverts back to a "normal" boot menu. Unrestricted admin mode is now the default.

Security impact? This is hard to quantify. It is important to understand that <code>user-sysmaint-split</code> is an additional security feature, not a silver bullet.

The security concept of user versus administrative account isolation, implemented by the <code>user-sysmaint-split</code> package, is a standard feature on mainstream mobile operating systems such as Android and iOS. These mobile operating systems limit the rights of the device owner and reserve full administrative access for the device manufacturer (OEM). The purpose of this, among other security aspects, is to enforce [[Miscellaneous_Threats_to_User_Freedom#mobile_devices_restrictions|mobile device restrictions]], prioritizing the wishes of OEMs and application developers over user preferences. See also the [[Miscellaneous_Threats_to_User_Freedom|General Threats to User Freedom]] wiki chapter [[Miscellaneous_Threats_to_User_Freedom#Administrative_Rights|Administrative Rights]].

<code>user-sysmaint-split</code> improves security in many contexts. For example, if a user is using a dedicated {{VM}} in a session only for web browsing, then there is no need for the default account <code>user</code> in that VM to ever gain root rights.

However, in other contexts such as on servers or development environments, <code>user-sysmaint-split</code> might offer little or no additional security, or degrade usability to unproductive levels.

There have been times when <code>user-sysmaint-split</code> was unavailable and nothing catastrophic occurred. At worst, this reduces the security level to the same state as before <code>user-sysmaint-split</code> had been introduced.

See also [[Root#Rationale_for_Protecting_the_Root_Account|Rationale for Protecting the Root Account]].

= Optional Restrictions =
After removal, the user can configure <code>sudo</code> and/or other privilege escalation tools as usual.

= Footnotes =
<references/>
{{Footer}}
[[Category: Design]]
[[Category: Development]]